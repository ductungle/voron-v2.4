#####################################################################
#   Device ID's
#####################################################################
[mcu rpi]
serial: /tmp/klipper_host_mcu
[include fluidd.cfg]

#####################################################################
#   Happy Hare includes
#####################################################################
[include mmu/addons/mmu_erec_cutter.cfg]

#[include mmu/base/*.cfg]
#[include mmu/optional/client_macros.cfg]
##[include mmu/optional/mmu_ercf_compat.cfg]
#[include mmu/optional/mmu_menu.cfg]
#[include mmu/addons/blobifier.cfg]
#[include mmu/base/mmu_filametrix.cfg]

#####################################################################
#   Configs
#####################################################################
[include configs/sb2209USB.cfg]
[include configs/cartographer.cfg]

#####################################################################
#   Includes
#####################################################################
[include print_area_bed_mesh.cfg]
#[include autoZ.cfg]

[exclude_object] 



[mcu]
serial: /dev/serial/by-id/usb-Klipper_stm32f446xx_0F002B000650534841313020-if00
[input_shaper]
#shaper_freq_x: 61
#shaper_type_x: mzv
#shaper_freq_y: 39
#shaper_type_y: mzv
shaper_freq_x: 77
shaper_type_x: 2hump_ei
shaper_freq_y: 47
shaper_type_y: 2hump_ei

#####################################################################
#   Basic Klipper and Printer setup
#####################################################################

[printer]
kinematics: corexy
max_velocity: 300  
max_accel: 3000  			   #Max 4000
max_z_velocity: 15 			#Max 15 for 12V TMC Drivers, can increase for 24V
max_z_accel: 350
square_corner_velocity: 5.0


[idle_timeout]
timeout: 1800

[force_move]
enable_force_move: True

#####################################################################
#   Includes
#####################################################################

[include configs/steppers.cfg]
[include configs/temperature_sensors.cfg]
[include configs/fans.cfg]
[include configs/leds.cfg]
[include configs/display.cfg]

#####################################################################
# 	Macros
#####################################################################

[include macros/print_start_end.cfg]
[include macros/clean_nozzle.cfg]



[gcode_macro CLEAN_DA_NOZZLE]
variable_start_x: 67
variable_start_y: 300
variable_start_z: 4
variable_wipe_dist: 20
variable_wipe_qty: 10
variable_wipe_spd: 200
variable_raise_distance: 10

gcode:
 {% if "xyz" not in printer.toolhead.homed_axes %}
   G28
 {% endif %}
 
 G90                                            ; absolute positioning
 ## Move nozzle to start position
 G1 X{start_x} Y{start_y} F6000
 G1 Z{start_z} F1500

 ## Wipe nozzle
 {% for wipes in range(1, (wipe_qty + 1)) %}
   G1 X{start_x + wipe_dist} F{wipe_spd * 60}
   G1 X{start_x} F{wipe_spd * 60}
 {% endfor %}

 ##m Move nozzle in y t prevent hitting klicky
 G1 Y{270}

 ## Raise nozzle
 G1 Z{raise_distance}


#####################################################################
# 	Homing and Gantry Adjustment Routines
#####################################################################


[safe_z_home]
##	XY Location of the Z Endstop Switch
##	Update -10,-10 to the XY coordinates of your endstop pin 
##	(such as 157,305) after going through Z Endstop Pin
##	Location Definition step.
home_xy_position    :150, 150
speed               :300
z_hop               :10
z_hop_speed         :10.0


[quad_gantry_level]
##	Use QUAD_GANTRY_LEVEL to level a gantry.
##	Min & Max gantry corners - measure from nozzle at MIN (0,0) and 
##	MAX (250, 250), (300,300), or (350,350) depending on your printer size
##	to respective belt positions

#--------------------------------------------------------------------
##	Gantry Corners for 300mm Build
##	Uncomment for 300mm build
gantry_corners:
	-60,-10
	360,370
##	Probe points
points:
	50,25
	50,225
	250,225
	250,25
#--------------------------------------------------------------------
speed: 500
horizontal_move_z: 10
retries: 5
retry_tolerance: 0.0075
max_adjust: 10

########################################
# EXP1 / EXP2 (display) pins
########################################

[board_pins]
aliases:
    # EXP1 header
    EXP1_1=PE8, EXP1_2=PE7,
    EXP1_3=PE9, EXP1_4=PE10,
    EXP1_5=PE12, EXP1_6=PE13,    # Slot in the socket on this side
    EXP1_7=PE14, EXP1_8=PE15,
    EXP1_9=<GND>, EXP1_10=<5V>,

    # EXP2 header
    EXP2_1=PA6, EXP2_2=PA5,
    EXP2_3=PB1, EXP2_4=PA4,
    EXP2_5=PB2, EXP2_6=PA7,      # Slot in the socket on this side
    EXP2_7=PC15, EXP2_8=<RST>,
    EXP2_9=<GND>, EXP2_10=<5V>



#--------------------------------------------------------------------


#####################################################################
# 	Macros
#####################################################################
#[bed_mesh]
#speed: 300
#horizontal_move_z: 20
#mesh_min: 40, 40
#mesh_max: 260,260
#fade_start: 0.6
#fade_end: 10.0
#probe_count: 5,5
#algorithm: bicubic
#relative_reference_index: 12
#zero_reference_position: 150, 150



[include moonraker_obico_macros.cfg]

#*# <---------------------- SAVE_CONFIG ---------------------->
#*# DO NOT EDIT THIS BLOCK OR BELOW. The contents are auto-generated.
#*#
#*# [heater_bed]
#*# control = pid
#*# pid_kp = 39.628
#*# pid_ki = 1.601
#*# pid_kd = 245.200
#*#
#*# [extruder]
#*#
#*# [stepper_z]
#*# position_endstop = -0.525
#*#
#*# [probe]
#*#
#*# [bed_mesh default]
#*# version = 1
#*# points =
#*# 	-0.035083, -0.028725, -0.026385, -0.025384, -0.020898, -0.017690, -0.017672, -0.015102, -0.012754, -0.012732, -0.013571, -0.013362, -0.011155, -0.014465, -0.014750, -0.012779, -0.015170, -0.016617, -0.018635, -0.016527, -0.015679, -0.015988, -0.016575, -0.018851, -0.020501, -0.022276, -0.023653, -0.024707, -0.024053, -0.025441
#*# 	-0.036543, -0.031213, -0.028626, -0.025640, -0.023077, -0.019764, -0.017680, -0.015716, -0.014192, -0.015811, -0.014363, -0.012752, -0.013733, -0.014569, -0.014252, -0.015609, -0.018323, -0.018427, -0.018667, -0.019916, -0.020687, -0.018922, -0.017329, -0.023979, -0.021486, -0.020727, -0.022570, -0.024629, -0.023009, -0.019024
#*# 	-0.034943, -0.035068, -0.024308, -0.025467, -0.025591, -0.017965, -0.013438, -0.014351, -0.017061, -0.009545, -0.012570, -0.014751, -0.011135, -0.010333, -0.014684, -0.018329, -0.015136, -0.018441, -0.023808, -0.021385, -0.021859, -0.020928, -0.022283, -0.024646, -0.024469, -0.023897, -0.022355, -0.019461, -0.018942, -0.019472
#*# 	-0.033430, -0.030973, -0.029538, -0.025437, -0.022976, -0.020763, -0.016478, -0.015703, -0.014008, -0.014398, -0.011643, -0.011083, -0.012971, -0.014549, -0.015880, -0.016361, -0.017960, -0.019988, -0.019192, -0.023847, -0.022965, -0.018775, -0.022289, -0.026970, -0.023460, -0.020245, -0.023936, -0.017914, -0.014986, -0.019070
#*# 	-0.031897, -0.033486, -0.022261, -0.020745, -0.025503, -0.019345, -0.013149, -0.019383, -0.013545, -0.012988, -0.010601, -0.012756, -0.016007, -0.009668, -0.014317, -0.016028, -0.011154, -0.012763, -0.017603, -0.016730, -0.015915, -0.019245, -0.019206, -0.019033, -0.020562, -0.019134, -0.019107, -0.017518, -0.016403, -0.018321
#*# 	-0.029513, -0.026685, -0.025371, -0.022219, -0.019049, -0.016257, -0.014734, -0.014277, -0.012610, -0.011914, -0.011234, -0.010753, -0.010303, -0.011155, -0.008757, -0.009410, -0.010965, -0.006389, -0.007852, -0.010440, -0.010453, -0.009499, -0.015634, -0.014290, -0.014273, -0.012615, -0.011542, -0.012717, -0.008007, -0.012292
#*# 	-0.024599, -0.024583, -0.026364, -0.017331, -0.020667, -0.017098, -0.012717, -0.016643, -0.014927, -0.014957, -0.014372, -0.012711, -0.012773, -0.006396, -0.004806, -0.011098, -0.008681, -0.006270, -0.009471, -0.007134, -0.005969, -0.007985, -0.010294, -0.014239, -0.010329, -0.010350, -0.007947, -0.005938, -0.004887, -0.009176
#*# 	-0.025413, -0.022615, -0.022073, -0.019739, -0.017486, -0.017165, -0.016619, -0.017587, -0.017441, -0.017434, -0.014530, -0.011970, -0.009639, -0.008043, -0.006419, -0.006584, -0.007936, -0.006472, -0.008062, -0.006745, -0.005999, -0.005736, -0.007558, -0.009760, -0.008799, -0.006945, -0.006602, -0.000809, -0.001703, -0.006661
#*# 	-0.024864, -0.022984, -0.022239, -0.019931, -0.017353, -0.016811, -0.017513, -0.019712, -0.017062, -0.018893, -0.019035, -0.012438, -0.012630, -0.009564, -0.008076, -0.010256, -0.010185, -0.009499, -0.011050, -0.010379, -0.008719, -0.008309, -0.008732, -0.011067, -0.009451, -0.007902, -0.006310, -0.003534, -0.002949, -0.008081
#*# 	-0.026756, -0.025527, -0.024392, -0.022175, -0.019086, -0.017577, -0.019076, -0.020650, -0.020526, -0.019135, -0.017490, -0.012956, -0.012373, -0.011081, -0.011119, -0.012337, -0.011592, -0.011940, -0.012753, -0.012079, -0.011159, -0.009621, -0.010395, -0.010748, -0.010931, -0.010118, -0.009550, -0.003985, -0.006406, -0.009574
#*# 	-0.030212, -0.022273, -0.023159, -0.022328, -0.014645, -0.016815, -0.020657, -0.017591, -0.018717, -0.018969, -0.012753, -0.011143, -0.009994, -0.009564, -0.009233, -0.009592, -0.009546, -0.010752, -0.009969, -0.011169, -0.009621, -0.008063, -0.008794, -0.009590, -0.011109, -0.010878, -0.007715, -0.007625, -0.009173, -0.009543
#*# 	-0.028848, -0.026947, -0.023897, -0.021387, -0.019074, -0.018498, -0.019782, -0.019059, -0.017710, -0.015878, -0.014068, -0.011995, -0.010953, -0.008164, -0.008546, -0.007943, -0.009547, -0.009673, -0.009957, -0.008713, -0.006770, -0.008545, -0.009347, -0.010850, -0.011184, -0.012684, -0.012407, -0.011586, -0.011405, -0.011143
#*# 	-0.031819, -0.025276, -0.023939, -0.025411, -0.020227, -0.019886, -0.020651, -0.016706, -0.015965, -0.011974, -0.009741, -0.011332, -0.007757, -0.007169, -0.006031, -0.007988, -0.005662, -0.008072, -0.009179, -0.002550, -0.002524, -0.006345, -0.007591, -0.007827, -0.009734, -0.012632, -0.011915, -0.011917, -0.012756, -0.011142
#*# 	-0.028603, -0.025522, -0.024067, -0.023887, -0.022386, -0.021976, -0.019495, -0.015946, -0.012602, -0.009421, -0.007895, -0.007843, -0.006422, -0.005364, -0.003495, -0.005041, -0.006354, -0.006388, -0.004788, -0.000251, 0.001590, 0.000398, -0.002963, -0.005009, -0.006853, -0.009831, -0.011384, -0.010153, -0.008807, -0.008827
#*# 	-0.027392, -0.022680, -0.021906, -0.022314, -0.021585, -0.020320, -0.015995, -0.013947, -0.008700, -0.004873, -0.004872, -0.003115, -0.004556, -0.004798, -0.004051, -0.003491, -0.002929, -0.004025, -0.002857, -0.000075, 0.002122, 0.003078, 0.001554, -0.000854, -0.003222, -0.006332, -0.008514, -0.006728, -0.004862, -0.006490
#*# 	-0.030228, -0.025504, -0.023332, -0.023945, -0.023919, -0.022861, -0.019279, -0.014362, -0.009635, -0.007206, -0.005576, -0.006721, -0.006537, -0.007254, -0.006361, -0.005964, -0.005613, -0.006405, -0.005380, -0.003963, -0.001775, -0.000100, 0.001385, -0.000520, -0.003411, -0.005665, -0.007286, -0.007966, -0.005511, -0.004834
#*# 	-0.035044, -0.029499, -0.027031, -0.026345, -0.027133, -0.024489, -0.019973, -0.015222, -0.010560, -0.008765, -0.007070, -0.008812, -0.009482, -0.006497, -0.007016, -0.005538, -0.006976, -0.007560, -0.009703, -0.008002, -0.006525, -0.003158, -0.000959, -0.000934, -0.003216, -0.006803, -0.008908, -0.009149, -0.008011, -0.008165
#*# 	-0.039716, -0.035233, -0.033646, -0.033085, -0.030226, -0.027443, -0.022288, -0.017427, -0.013480, -0.012550, -0.012669, -0.012513, -0.012278, -0.011120, -0.008633, -0.007211, -0.008851, -0.010853, -0.012189, -0.012489, -0.011106, -0.007847, -0.004557, -0.001592, -0.001834, -0.007637, -0.011121, -0.012768, -0.012755, -0.012606
#*# 	-0.039863, -0.039930, -0.035888, -0.035068, -0.031902, -0.027609, -0.023809, -0.018298, -0.013817, -0.013543, -0.014565, -0.012761, -0.012669, -0.011121, -0.007201, -0.006391, -0.008346, -0.009547, -0.012759, -0.014380, -0.012986, -0.011953, -0.007640, -0.004732, -0.003429, -0.007896, -0.012707, -0.014214, -0.015742, -0.015882
#*# 	-0.042367, -0.038938, -0.039554, -0.035930, -0.032439, -0.029423, -0.023887, -0.019615, -0.017078, -0.016043, -0.017466, -0.016525, -0.015097, -0.012149, -0.008812, -0.009459, -0.008976, -0.012954, -0.014445, -0.015502, -0.015915, -0.012756, -0.011106, -0.007993, -0.006367, -0.008896, -0.012626, -0.015681, -0.017478, -0.018252
#*# 	-0.044371, -0.040698, -0.038280, -0.035301, -0.032979, -0.028322, -0.024080, -0.020780, -0.018849, -0.017564, -0.019035, -0.018237, -0.015785, -0.014196, -0.009946, -0.008011, -0.009554, -0.011279, -0.012724, -0.012817, -0.013566, -0.012698, -0.012236, -0.011513, -0.010652, -0.011539, -0.013353, -0.015471, -0.017641, -0.018942
#*# 	-0.041494, -0.040057, -0.038242, -0.033656, -0.027334, -0.027126, -0.023715, -0.019131, -0.021814, -0.018609, -0.017395, -0.017462, -0.015103, -0.011848, -0.008594, -0.006252, -0.006252, -0.007610, -0.007156, -0.008964, -0.011154, -0.009171, -0.011730, -0.012730, -0.012540, -0.012144, -0.012049, -0.012581, -0.013972, -0.015819
#*# 	-0.039478, -0.035032, -0.032852, -0.028748, -0.025305, -0.022273, -0.020483, -0.019055, -0.016417, -0.014651, -0.014273, -0.012755, -0.011933, -0.009535, -0.005124, -0.002836, -0.001906, -0.003205, -0.003257, -0.003264, -0.004861, -0.006434, -0.008466, -0.011343, -0.012857, -0.011197, -0.009148, -0.008833, -0.011157, -0.013842
#*# 	-0.038479, -0.038236, -0.034594, -0.028745, -0.028755, -0.024493, -0.021123, -0.020713, -0.019919, -0.015880, -0.012562, -0.013568, -0.010751, -0.007054, -0.005523, -0.004744, -0.001818, -0.000100, -0.004747, -0.004832, -0.004485, -0.005698, -0.011161, -0.012380, -0.013921, -0.012582, -0.011154, -0.007566, -0.009443, -0.014936
#*# 	-0.041412, -0.037184, -0.033898, -0.031772, -0.027166, -0.025442, -0.022264, -0.020650, -0.017536, -0.014651, -0.012755, -0.011159, -0.009085, -0.007233, -0.004320, -0.002113, -0.000092, -0.001686, -0.004752, -0.005276, -0.006792, -0.007943, -0.009599, -0.012603, -0.013556, -0.012715, -0.010306, -0.008002, -0.009771, -0.014605
#*# 	-0.045918, -0.038272, -0.035069, -0.035172, -0.030783, -0.025093, -0.027145, -0.025594, -0.018715, -0.015810, -0.017658, -0.014636, -0.009547, -0.012668, -0.009745, -0.003923, -0.003280, -0.008745, -0.011161, -0.008740, -0.011695, -0.012609, -0.010351, -0.012716, -0.015825, -0.015630, -0.012763, -0.012311, -0.014221, -0.017405
#*# 	-0.039166, -0.036901, -0.034257, -0.031003, -0.027126, -0.024289, -0.021468, -0.020598, -0.017674, -0.014385, -0.012662, -0.010382, -0.008064, -0.007612, -0.004808, -0.004183, -0.002512, -0.003104, -0.004763, -0.006535, -0.007946, -0.007958, -0.008812, -0.010374, -0.011068, -0.011875, -0.011152, -0.011164, -0.012766, -0.014258
#*# 	-0.034801, -0.032136, -0.029836, -0.027310, -0.024313, -0.018687, -0.018814, -0.019417, -0.014369, -0.012643, -0.010336, -0.008314, -0.004824, -0.005094, -0.006727, -0.003111, -0.001688, -0.001959, -0.002448, -0.004724, -0.004824, -0.006396, -0.007203, -0.009625, -0.010265, -0.011773, -0.012264, -0.013398, -0.014875, -0.013447
#*# 	-0.029472, -0.025705, -0.024799, -0.023962, -0.021026, -0.019084, -0.015929, -0.014175, -0.011182, -0.008243, -0.005775, -0.003980, -0.003131, -0.002467, -0.001569, -0.000814, 0.000113, 0.000800, 0.001124, -0.002957, -0.004263, -0.005562, -0.006667, -0.009533, -0.011553, -0.012234, -0.014204, -0.015966, -0.015983, -0.013934
#*# 	-0.023903, -0.023025, -0.023477, -0.023943, -0.021284, -0.017442, -0.015805, -0.013099, -0.009850, -0.005887, -0.003556, -0.001649, 0.001620, 0.000183, -0.000116, -0.000778, 0.001502, -0.000061, 0.001493, -0.001626, -0.003932, -0.006763, -0.007234, -0.010777, -0.012952, -0.014644, -0.017570, -0.019031, -0.020266, -0.017370
#*# tension = 0.2
#*# min_x = 40.0
#*# algo = bicubic
#*# y_count = 30
#*# mesh_y_pps = 2
#*# min_y = 40.0
#*# x_count = 30
#*# max_y = 260.0
#*# mesh_x_pps = 2
#*# max_x = 260.0
#*#
#*# [scanner model default]
#*# model_coef = 1.3637297647578879,
#*# 	  1.807525996042669,
#*# 	  0.7628806362148711,
#*# 	  0.2979360973147329,
#*# 	  0.41698140182623084,
#*# 	  0.571062121929289,
#*# 	  -0.28243053587611877,
#*# 	  -0.5706830390017905,
#*# 	  0.28945893421728736,
#*# 	  0.34735939418792344
#*# model_domain = 3.208606271270468e-07,3.3369927253188336e-07
#*# model_range = 0.100000,5.000000
#*# model_temp = 23.724033
#*# model_offset = 0.00000
#*# model_mode = touch
#*# model_fw_version = CARTOGRAPHER 5.0.0
#*#
#*# [scanner]
#*# mode = touch
#*# scanner_touch_threshold = 3250
#*# scanner_touch_speed = 3
